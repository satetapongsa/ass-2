# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° devops
sudo groupadd devops

# ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (w) ‡πÅ‡∏•‡∏∞ student ‡πÄ‡∏Ç‡πâ‡∏≤ devops
sudo usermod -aG devops w
sudo usermod -aG devops student
getent group devops
devops:x:1001:w,student
# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
sudo mkdir -p /srv/team

# ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô devops
sudo chown :devops /srv/team

# ‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå 775
sudo chmod 775 /srv/team
ls -ld /srv/team
drwxrwxr-x 2 root devops 4096 Sep 11 12:00 /srv/team
# ‡∏ï‡∏±‡πâ‡∏á setgid ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏™‡∏∑‡∏ö‡∏ó‡∏≠‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° devops
sudo chmod g+s /srv/team

# ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á umask ‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏õ‡πá‡∏ô 002
umask 002
ls -ld /srv/team
drwxrwsr-x 2 root devops 4096 Sep 11 12:00 /srv/team
cd /srv/team
echo "Hello from w" > file_w.txt
ls -l
-rw-rw-r-- 1 w devops 16 Sep 11 12:05 file_w.txt
cd /srv/team
echo "Hello from student" > file_student.txt
ls -l
echo "w edited student file" >> file_student.txt
cat file_student.txt
echo "student edited w file" >> file_w.txt
cat file_w.txt
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° devops
getent group devops

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
ls -ld /srv/team

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô /srv/team
ls -l /srv/team
devops:x:1001:w,student
drwxrwsr-x 2 root devops 4096 Sep 11 12:00 /srv/team
-rw-rw-r-- 1 w devops 16 Sep 11 12:05 file_w.txt
-rw-rw-r-- 1 student devops 22 Sep 11 12:06 file_student.txt

‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î:

‡∏Å‡∏•‡∏∏‡πà‡∏° = devops

‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå = 775 + setgid

‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏ü‡∏•‡πå = 664 (-rw-rw-r--)

‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ

üí° Tip:

umask 002 ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô 644 ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ

chmod g+s ‡∏ö‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏™‡∏∑‡∏ö‡∏ó‡∏≠‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° devops ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥






#!/bin/bash

# -------------------------------
# 1Ô∏è‚É£ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° devops
# -------------------------------
sudo groupadd -f devops            # -f ‡∏Ñ‡∏∑‡∏≠‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà error
sudo usermod -aG devops w
sudo usermod -aG devops student

echo "=== ‡∏Å‡∏•‡∏∏‡πà‡∏° devops ‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ==="
getent group devops
echo

# -------------------------------
# 2Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πÄ‡∏£‡πá‡∏Ñ‡∏ó‡∏≠‡∏£‡∏µ /srv/team
# -------------------------------
sudo mkdir -p /srv/team
sudo chown :devops /srv/team
sudo chmod 2775 /srv/team   # 2 = setgid bit

echo "=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö /srv/team ==="
ls -ld /srv/team
echo

# -------------------------------
# 3Ô∏è‚É£ ‡∏ï‡∏±‡πâ‡∏á umask 002
# -------------------------------
echo "Setting umask 002 temporarily for this script"
umask 002

# -------------------------------
# 4Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≠‡∏á user
# -------------------------------

# User w ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
sudo -u w bash -c "echo 'Hello from w' > /srv/team/file_w.txt"
# User student ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
sudo -u student bash -c "echo 'Hello from student' > /srv/team/file_student.txt"

# -------------------------------
# 5Ô∏è‚É£ ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏±‡∏ô
# -------------------------------
sudo -u w bash -c "echo 'w edited student file' >> /srv/team/file_student.txt"
sudo -u student bash -c "echo 'student edited w file' >> /srv/team/file_w.txt"

# -------------------------------
# 6Ô∏è‚É£ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
# -------------------------------
echo "=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô /srv/team ==="
ls -l /srv/team


chmod +x devops_team_setup.sh
./devops_team_setup.sh

=== ‡∏Å‡∏•‡∏∏‡πà‡∏° devops ‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ===
devops:x:1001:w,student

=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö /srv/team ===
drwxrwsr-x 2 root devops 4096 Sep 11 12:00 /srv/team

=== ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô /srv/team ===
-rw-rw-r-- 1 w devops 38 Sep 11 12:05 file_w.txt
-rw-rw-r-- 1 student devops 44 Sep 11 12:06 file_student.txt
